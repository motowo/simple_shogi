# シンプル将棋

ブラウザ上で人間同士が将棋を指すことができるシンプルなWebアプリケーション

## 概要

- **目的**: ブラウザ上で人間同士が将棋を指すことができるシンプルなアプリケーションの提供
- **対象ユーザー**: 将棋をオンラインで指したいPCユーザー
- **技術スタック**: Vue.js 3 + TypeScript + Composition API
- **インフラ**: Docker + Docker Compose
- **デプロイ**: 静的ファイルとしてGitHub Pages対応

## 🎮 実装完了機能

### 核心ゲーム機能
- ✅ **完全な将棋盤（9×9）** - 正確な盤面表示とマス目管理
- ✅ **全駒種対応** - 王・飛・角・金・銀・桂・香・歩の8種類の駒
- ✅ **正確な移動ルール** - 駒種別の移動パターン実装
- ✅ **成り駒機能** - 成り駒圏内での成り判定と選択ダイアログ
- ✅ **持ち駒システム** - 駒の取得・駒打ち・駒打ち制限ルール
- ✅ **王手・詰み判定** - 完全な王手・詰み検出アルゴリズム
- ✅ **手番制御** - 先手・後手の交互手番管理
- ✅ **不正手防止** - 王手放置防止などの完全ルール検証

### 高度なUI機能
- ✅ **対戦開始ダイアログ** - 対局開始の確認と意図的な操作フロー
- ✅ **対局時間計測** - リアルタイム時間追跡（持ち時間・考慮時間）
- ✅ **対局履歴保存** - ローカルストレージへの対局記録保存
- ✅ **統計情報表示** - 勝率・平均対局時間・手数などの統計
- ✅ **手順表示** - 棋譜形式での手順記録・表示
- ✅ **直感的操作** - クリック選択・可能手ハイライト
- ✅ **視覚的フィードバック** - 王手・詰み状態の明確な表示
- ✅ **ゲーム管理** - 投了・リセット・新規対局機能
- ✅ **勝利表示ダイアログ** - 対局終了時の結果表示と次回対局への誘導

### 技術・品質機能
- ✅ **完全なTypeScript** - 型安全性とコード品質の保証
- ✅ **包括的テスト** - 18のテストファイルによる高いテストカバレッジ
- ✅ **レスポンシブデザイン** - PC環境での最適化
- ✅ **ダークモード対応** - CSS media queriesによる自動切り替え
- ✅ **キーボードショートカット** - Ctrl+R（リセット）、Escape（選択解除）
- ✅ **アクセシビリティ** - フォーカス管理とスクリーンリーダー対応

## 🏗️ アーキテクチャ

### コンポーネント構成
```
frontend/src/
├── components/
│   ├── ShogiBoard.vue          # メインゲーム盤面
│   ├── ShogiPiece.vue          # 個別駒表示
│   ├── CapturedPieces.vue      # 持ち駒表示
│   ├── GameTimer.vue           # 時間計測
│   ├── GameHistory.vue         # 対局履歴
│   ├── MoveHistory.vue         # 手順表示
│   ├── GameStartDialog.vue     # 対戦開始ダイアログ
│   ├── PromotionDialog.vue     # 成り選択ダイアログ
│   ├── ResetButton.vue         # リセットボタン
│   └── ResignButton.vue        # 投了ボタン
├── utils/
│   ├── boardUtils.ts           # 盤面管理
│   ├── initialBoard.ts         # 初期配置
│   ├── moveValidation.ts       # 移動検証
│   ├── checkDetection.ts       # 王手・詰み判定
│   ├── capturedPieces.ts       # 持ち駒管理
│   ├── promotion.ts            # 成り処理
│   └── gameStorage.ts          # 履歴保存
└── types/
    └── shogi.ts                # 型定義
```

### Docker構成
```yaml
services:
  frontend:
    - Vue.js 3 + TypeScript
    - Vite開発サーバー
    - Nginx（プロダクション）
    - ポート: 8080
```

## 🚀 クイックスタート

### 環境起動
```bash
# リポジトリをクローン
git clone https://github.com/motowo/simple_shogi.git
cd simple_shogi

# Docker環境を起動
docker-compose up -d

# ブラウザで http://localhost:8080 を開く
```

### 開発コマンド
```bash
# 開発サーバー起動
docker-compose exec frontend npm run dev

# テスト実行
docker-compose exec frontend npm run test

# コード品質チェック
docker-compose exec frontend npm run lint

# コード整形
docker-compose exec frontend npm run format

# プロダクションビルド
docker-compose exec frontend npm run build
```

## 🧪 テスト・品質管理

### テストカバレッジ
- **18のテストファイル** - 全主要機能をカバー
- **コンポーネントテスト** - 11のVueコンポーネントテスト
- **ユニットテスト** - 7のユーティリティ関数テスト
- **統合テスト** - ゲームフロー全体のテスト

### 品質管理ツール
- **ESLint** - コード品質とベストプラクティス
- **Prettier** - 自動コード整形
- **TypeScript** - 型安全性とコンパイル時エラー検出
- **Vitest** - 高速テスト実行とカバレッジ

## 📋 開発フロー

### 1. 開発開始
```bash
git checkout main
git pull origin main
git checkout -b feature/新機能名
docker-compose up -d
```

### 2. TDD実装
```bash
# 1. テスト作成
# 2. テスト失敗確認
# 3. 最小限の実装
# 4. テスト通過確認
# 5. リファクタリング
```

### 3. 品質チェック
```bash
npm run lint    # コード品質
npm run format  # コード整形
npm run test    # テスト実行
```

### 4. 完了・マージ
```bash
git add .
git commit -m "feat: 新機能の実装"
git push -u origin feature/新機能名
# プルリクエスト作成
```

## 🔮 今後の開発計画

### 📅 次期実装予定（優先度：高）

#### 1. 棋譜エクスポート機能
- **KIF形式エクスポート** - 標準棋譜形式での出力
- **CSV形式エクスポート** - 統計分析用データ出力
- **クリップボードコピー** - 手軽な棋譜共有

#### 2. 対局再生機能
- **手順再生** - 保存された対局の再生
- **早送り・巻き戻し** - 任意速度での手順確認
- **局面移動** - 特定手数への直接移動

#### 3. 音声・効果音機能
- **駒音** - リアルな駒音再生
- **警告音** - 王手・詰み時の音声通知
- **音量調整** - 詳細な音響設定

### 🔧 将来実装候補（優先度：中）

#### 4. 対局設定機能
- **持ち時間設定** - 切れ負け対応
- **秒読み機能** - 本格的な時間制限
- **対局者名設定** - カスタマイズ可能な表示名

#### 5. 盤面テーマ機能
- **テーマ切り替え** - 複数の盤面デザイン
- **駒スタイル変更** - 異なる駒セット
- **カラーカスタマイズ** - 個人設定対応

#### 6. 局面分析機能
- **利き表示** - 駒の利き可視化
- **形勢判断** - 攻守バランス分析
- **危険手警告** - 戦術的アドバイス

### 🎯 長期ビジョン（優先度：低）

#### 7. AIとの対局
- **複数難易度AI** - 初心者から上級者まで対応
- **思考時間調整** - AI思考の可視化
- **ヒント機能** - 学習支援機能

#### 8. オンライン対戦
- **リアルタイム対局** - WebSocketによる同期
- **観戦機能** - 対局観戦システム
- **チャット機能** - 対局中コミュニケーション

#### 9. 詰将棋モード
- **問題出題** - 段階的詰将棋問題
- **正解判定** - 自動採点システム
- **学習進捗** - 習熟度管理

## 📊 完了の定義（DoD）

### 機能要件
- ✅ ブラウザで盤面が表示され、駒がルール通りに動く
- ✅ プレイヤーが交互に操作可能
- ✅ 成り・投了・詰み判定が正しく処理される
- ✅ リセットでゲームを再スタートできる
- ✅ 対局時間が正確に計測される
- ✅ 対局履歴が保存・表示される
- ✅ 対戦開始ダイアログで意図的な対局開始が可能
- ✅ 勝利表示ダイアログから新しいゲームへの自然な遷移

### 技術要件
- ✅ 主要ブラウザ（Chrome, Edge, Firefox）で動作確認済み
- ✅ TypeScript型安全性100%
- ✅ テストカバレッジ90%以上
- ✅ ESLint・Prettier通過
- ✅ レスポンシブデザイン対応

## 🛠️ 技術仕様

| 項目 | 技術・ツール |
|------|-------------|
| **フロントエンド** | Vue.js 3 + TypeScript + Composition API |
| **ビルドツール** | Vite + TypeScript |
| **テスト** | Vitest + Vue Test Utils |
| **コード品質** | ESLint + Prettier |
| **スタイル** | Scoped CSS + CSS Variables |
| **型システム** | TypeScript Strict Mode |
| **状態管理** | Composition API + Reactive |
| **データ永続化** | LocalStorage |
| **インフラ** | Docker + Docker Compose |
| **デプロイ** | GitHub Pages対応 |

## 🤝 コントリビューション

### 開発参加方法
1. **Issue作成** - 新機能要望・バグ報告
2. **フォーク** - リポジトリの個人フォーク
3. **ブランチ作成** - feature/改善内容
4. **実装** - TDD + 品質チェック
5. **プルリクエスト** - 詳細な変更説明

### コードスタイル
- **TypeScript必須** - 型安全性の確保
- **TDD実践** - テストファースト開発
- **ESLint準拠** - コード品質標準
- **Prettier使用** - 自動整形

## 📝 ライセンス

MIT License

---

**開発者**: [motowo](https://github.com/motowo)  
**最終更新**: 2025年1月  
**バージョン**: 1.0.0